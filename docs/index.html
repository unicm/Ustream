<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">Ustream流计算平台 | Ustream流计算平台</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://unicm.github.io/Ustream/docs/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Ustream流计算平台 | Ustream流计算平台"><meta data-react-helmet="true" name="description" content="简介"><meta data-react-helmet="true" property="og:description" content="简介"><link data-react-helmet="true" rel="icon" href="/Ustream/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://unicm.github.io/Ustream/docs/"><link data-react-helmet="true" rel="alternate" href="https://unicm.github.io/Ustream/docs/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://unicm.github.io/Ustream/docs/" hreflang="x-default"><link rel="stylesheet" href="/Ustream/assets/css/styles.866f7346.css">
<link rel="preload" href="/Ustream/assets/js/runtime~main.a8b5188d.js" as="script">
<link rel="preload" href="/Ustream/assets/js/main.debedaab.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Ustream/"><div class="navbar__logo"><img src="/Ustream/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/Ustream/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Ustream流计算平台</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Ustream/docs/">文档中心</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/unicm/Ustream.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/Ustream/docs/">Ustream流计算平台</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Ustream流计算平台</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="简介">简介<a class="hash-link" href="#简介" title="Direct link to heading">​</a></h2><p>Ustream流计算平台是一款基于Apache Flink构建的全托管产品，为您提供全托管的实时计算服务。 用户只需要专注于业务开发，无需关心集群运维。
平台提供作业管理、集群管理、资源管理、日志管理等一站式功能，提高作业开发运维效率。 作业类型支持SQL作业和自定义Jar包作业，运行模式支持
yarn_session模式和yarn_per模式。</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="架构">架构<a class="hash-link" href="#架构" title="Direct link to heading">​</a></h2><ul><li><p><code>ustream-server</code>
后端服务层，提供核心逻辑的API接口，为满足平台需求，提供高效服务能力。</p></li><li><p><code>sql-gateway</code>
sql执行层，主要负责解析执行flink SQL作业,与作业参数配置</p></li><li><p><code>ustream-ui</code>
前端应用层，提供系统的各种可视化操作界面</p></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="功能">功能<a class="hash-link" href="#功能" title="Direct link to heading">​</a></h2><ul><li><p><code>项目管理</code>：</p><ul><li>项目信息查看</li><li>项目新增 </li></ul></li><li><p><code>资源管理</code>：</p><ul><li>资源信息查看，资源新增上传</li><li>资源删除，资源查询</li></ul></li><li><p><code>函数管理</code>：</p><ul><li>函数信息查看，函数新增</li><li>函数修改，函数删除，资源查询</li></ul></li><li><p><code>应用开发</code>：</p><ul><li>支持应用目录式管理，udf应用，connector查看 任务运行支持yarn_per模式和yarn_session模式</li><li>作业类型支持JAR类型和SQL类型</li><li>支持flink作业界面化配置，运维监控，SQL格式化，SQL语法校验，SQL调试运行</li><li>支持运行结果和问题的看板展示</li></ul></li><li><p><code>应用运维</code>：</p><ul><li>支持对详情、状态、指标、日志、历史版本等作业的基础信息查看</li><li>支持savepoint功能，支持作业的启动、停止、编辑、删除等运维操作</li></ul></li><li><p><code>集群管理</code>：</p><ul><li>支持对集群详情、集群状态、集群日志等基础信息查看</li><li>支持集群的启动、停止、编辑、删除等运维操作</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="部署">部署<a class="hash-link" href="#部署" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="部署环境准备">部署环境准备<a class="hash-link" href="#部署环境准备" title="Direct link to heading">​</a></h3><table><thead><tr><th>环境</th><th>版本</th><th>备注</th></tr></thead><tbody><tr><td>jdk</td><td>1.8.0_181-b13</td><td>Web基础环境</td></tr><tr><td>mysql</td><td>5.7+</td><td>web数据存储</td></tr><tr><td>nginx</td><td>1.21.1</td><td>web前端访问</td></tr><tr><td>hdfs</td><td>HDP-2.6</td><td>资源存储管理</td></tr><tr><td>redis</td><td>4.0</td><td>调试缓存</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="获取代码">获取代码<a class="hash-link" href="#获取代码" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">#idea中克隆项目</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 克隆项目</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://xxx/ustream-platform.git</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="数据库初始化">数据库初始化<a class="hash-link" href="#数据库初始化" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">数据库初始化脚本在ustream-platform\sql\create\release-1.0.0_schema目录下</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ustream_ddl.sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ustream_dml.sql</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="修改配置">修改配置<a class="hash-link" href="#修改配置" title="Direct link to heading">​</a></h3><ul><li><p><code>后端配置</code>：</p><ul><li><p>修改application.properties</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">配置文件在ustream-server的resources目录下</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#mysql配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring.datasource.url=jdbc:mysql://***:3306/ustream?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false&amp;serverTimezone=GMT%2b8&amp;autoReconnect=true&amp;failOverReadOnly=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring.datasource.username=***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring.datasource.password=********</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#HDFS配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hdfs.url=hdfs://***.XXX:8020</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hdfs.userName=hdfs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kerberos.enable=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#带kerberos认证配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#dev.hdfs.url=hdfs://***:8020</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#dev.hdfs.userName=flink</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#dev.kerberos.enable=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#dev.kerberos.key.tabpath=/home/flink/flink.keytab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#dev.kerberos.principal=flink@EXAMPLE.COM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#dev.kerberos.dfs.namenode.kerberos.principal=nn/_HOST@EXAMPLE.COM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#redis配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring.redis.host=***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring.redis.port=7501</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring.redis.password=********</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#sql调试中缓存运行结果的key名称前缀</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redis.ustream.keyPrefix=ustream_console</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#系统配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.flink-bin-path=/data/flink/flink-1.11.2/bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.yarn-session-shell-name=yarn-session.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.input=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.output=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.resource-hdfs-pre=/tmp/flink_stream/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.resource-download-dir=/data/flink/flink_web/tmp/udf_jar/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.sql-gateway-jar=/data/flink/test/sql-gateway/medical-business-ustream-sql-gateway-1.0-SNAPSHOT.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.sql-gateway-jar-mainclass=medical.business.ustream.sqlgateway.Ulauncher</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.grafana-flink-url=http://***:3000/d/cWNVbGm7z/flink</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.flink-history-rest-address=http://***:8082/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.debug-hdfs-data-dir=/flink/app/debugData</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.debug-local-tmp-csv=/data/flink/flink_web/tmp/csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.allow-suffix-list[0]=txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.allow-suffix-list[1]=sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.allow-suffix-list[2]=conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.allow-suffix-list[3]=cfg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.allow-suffix-list[4]=py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.allow-suffix-list[5]=java</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.allow-suffix-list[6]=sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.allow-suffix-list[7]=xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.allow-suffix-list[8]=hql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.allow-suffix-list[9]=properties</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system.allow-suffix-list[10]=jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">udf.system.resources=&quot;&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>修改mysql数据库 ustream_system_dict 表</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">根据自己的集群信息修改对应key的value值</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul></li></ul><ul><li><p><code>sql执行层配置</code>：</p><ul><li><p>修改application.conf</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">配置文件在ustream-sql-gateway的resources目录下</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redis.host=&quot;***&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redis.port=7501</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redis.passwd=&quot;********&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redis.ustream.keyPrefix=&quot;ustream_console&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul></li></ul><ul><li><p><code>前端配置</code>：</p><ul><li><p>修改系统配置</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">#开发环境配置 .env.development</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#生产环境配置 .env.production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># base api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VUE_APP_BASE_API = &#x27;http://***:9110&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VUE_APP_DOWMLOAD_URL = &#x27;http://***:9110&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>修改vue.config.js</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">  devServer: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    port: port,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    open: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    disableHostCheck: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    overlay: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      warnings: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      errors: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;/dev-api&#x27;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        target: &#x27;http://***:9110&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pathRewrite: { &#x27;^/dev-api&#x27;: &#x27;&#x27; },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        changeOrigin: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  。。。</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="源码编译">源码编译<a class="hash-link" href="#源码编译" title="Direct link to heading">​</a></h3><ul><li><p><code>后端编译</code>：</p><ul><li><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">mvn clean install -DskipTests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">在ustream-server的target目录下生成medical-business-ustream-server.jar</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul></li><li><p><code>sql执行层编译</code>：</p><ul><li><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">编译模块：medical-business-ustream-sql-gateway</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">在ustream-sql-gateway的target目录下生成medical-business-ustream-sql-gateway-1.0-SNAPSHOT.jar</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul></li><li><p><code>前端编译</code>：</p><ul><li><p>Build Setup</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain"># 进入项目目录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd medical-business-ustream-ui</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 安装依赖</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 建议不要直接使用 cnpm 安装以来，会有各种诡异的 bug。可以通过如下操作解决 npm 下载速度慢的问题</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm install --registry=https://registry.npm.taobao.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 启动服务</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm run dev</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>发布</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain"># 构建测试环境</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm run build:stage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 构建生产环境</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm run build:prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">在ustream-ui下形成dist前端静态资源文件夹</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>其它</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain"># 预览发布环境效果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm run preview</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 预览发布环境效果 + 静态资源分析</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm run preview -- --report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 代码格式检查</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm run lint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 代码格式检查并自动修复</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm run lint -- --fix</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="部署生产">部署生产<a class="hash-link" href="#部署生产" title="Direct link to heading">​</a></h3><ul><li><p><code>后端部署</code>：</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">#上传jar的目录需要在配置文件中配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#system.sql-gateway-jar=/sql-gateway/medical-business-ustream-sql-gateway-1.0-SNAPSHOT.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1.把medical-business-ustream-server.jar上传到服务器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2.把medical-business-ustream-sql-gateway-1.0-SNAPSHOT.jar上传到服务器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3.把需要sql connect从flink官网下载到flink的lib目录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://nightlies.apache.org/flink/flink-docs-release-1.11/dev/table/connectors/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4.启动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nohup java -jar medical-business-ustream-server.jar 2&gt;&amp;1 &amp;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p><code>前端部署</code>：</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">1.上传dist前端静态资源文件到服务器（需要和nginx在同一个服务器）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2.配置文件 nginx.conf，添加开放访问静态资源的映射</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         listen       19004;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         server_name ***;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         add_header X-Frame-Options DENY;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         add_header X-Frame-Options &quot;SAMEORIGIN&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         add_header X-XSS-Protection &quot;1; mode=block&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         add_header X-Content-Type-Options &quot;nosniff&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         location /flink-computing-platform {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             alias   html/19004/flink-computing-platform/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             index  index.html index.htm;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3.启动nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./nginx</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="开发指南">开发指南<a class="hash-link" href="#开发指南" title="Direct link to heading">​</a></h2></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/unicm/Ustream.github.io/docs/README.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#简介" class="table-of-contents__link toc-highlight">简介</a></li><li><a href="#架构" class="table-of-contents__link toc-highlight">架构</a></li><li><a href="#功能" class="table-of-contents__link toc-highlight">功能</a></li><li><a href="#部署" class="table-of-contents__link toc-highlight">部署</a><ul><li><a href="#部署环境准备" class="table-of-contents__link toc-highlight">部署环境准备</a></li><li><a href="#获取代码" class="table-of-contents__link toc-highlight">获取代码</a></li><li><a href="#数据库初始化" class="table-of-contents__link toc-highlight">数据库初始化</a></li><li><a href="#修改配置" class="table-of-contents__link toc-highlight">修改配置</a></li><li><a href="#源码编译" class="table-of-contents__link toc-highlight">源码编译</a></li><li><a href="#部署生产" class="table-of-contents__link toc-highlight">部署生产</a></li></ul></li><li><a href="#开发指南" class="table-of-contents__link toc-highlight">开发指南</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/Ustream/docs">文档中心</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/unicm/Ustream.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>建议<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/unicm/Ustream.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Ustream流计算平台,unicm团队. 所有. </div></div></div></footer></div>
<script src="/Ustream/assets/js/runtime~main.a8b5188d.js"></script>
<script src="/Ustream/assets/js/main.debedaab.js"></script>
</body>
</html>